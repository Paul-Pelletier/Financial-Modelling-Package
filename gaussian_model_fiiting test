import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from modelling.gaussian_process_model import GaussianProcessModel

# Load data
data = pd.read_csv("testdata.csv", sep=";")

maturities = data['YTE']
forward_rates = data['calc']

# Initialize and fit the Gaussian Process model
model = GaussianProcessModel(length_scale=1.0, variance=100.0, noise_variance=0.01)
fitted_params = model.fit(maturities, forward_rates)
print("Fitted Parameters:", fitted_params)

# Predict forward rates
maturities_test = np.linspace(0, 3, 100)
predicted_rates = model.predict(maturities_test)

# Plot observed vs. predicted rates
plt.figure(figsize=(10, 6))
plt.plot(maturities, forward_rates, 'o', label="Observed Forward Rates")
plt.plot(maturities_test, predicted_rates.numpy(), '--', label="Predicted Forward Rates")
plt.title("Gaussian Process Model: Observed vs. Predicted Forward Rates")
plt.xlabel("Time to Maturity (Years)")
plt.ylabel("Forward Rate")
plt.legend()
plt.grid()
plt.show()
